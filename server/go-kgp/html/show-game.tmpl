{{ template "header.tmpl" }}

{{ with . }}

{{ $game := . }}

<p>
Game between
{{ with .South }}
  {{ if ne .Id 0 }}
    <a href="/agent/{{ .Id }}">
    {{ with .Name }}
       {{ . }}
    {{ else }}
       <em>Unnamed</em>
    {{ end }}
    </a>
  {{ else }}
    Anon.
  {{ end }}
{{ end }}
on the south side, and
{{ with .North }}
  {{ if ne .Id 0 }}
    <a href="/agent/{{ .Id }}">
    {{ with .Name }}
       {{ . }}
    {{ else }}
       <em>Unnamed</em>
    {{ end }}
    </a>
  {{ else }}
    Anon.
  {{ end }}
{{ end }}
on the north side.
</p>

<table class="move list">
  <thead>
      <tr>
	  <td>Nr</td>
	  <td>Pit</td>
	  <td>Agent</td>
	  <td>Comment</td>
      </tr>
  </thead>
  <tbody>
    {{ range $i, $m := .Moves }}
      <tr>
	<td>{{ $i }}</td>
	<td>{{ inc $m.Pit }}</td>
	<td>
	{{ with $m.Client }}
	  {{ if ne .Id 0 }}
	    <a href="/agent/{{ .Id }}">
	    {{ with .Name }}
	       {{ . }}
	    {{ else }}
	       <em>Unnamed</em>
	    {{ end }}
	    </a>
	  {{ else }}
	    Anon.
	  {{ end }}
	{{ end }}
	</td>
	<td>
	{{ with $m.Comment }}
	{{ . }}
	{{ else}}
	<em>No comment</em>
	{{ end }}
       </tr>
       <tr><td colspan="4">{{ draw . $game }}</td></tr>
    {{ else }}
       <tr><td colspan="4"><em>No moves</em></td></tr>
    {{ end }}
  </tbody>
</table>


{{ else }}
<p>Unknown game.</p>
{{ end }}

{{ template "footer.tmpl" }}
